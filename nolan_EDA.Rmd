---
title: "R Notebook"
output: github_document
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r setup}
library(tidyverse)
source("cleaning.R")
```


```{r}
# all_ratings %>% head()
all_ratings %>% summary()
```


```{r}
all_ratings %>%
  ggplot() +
  geom_point(aes(x = harvest_year, y = total_cup_points))
```

```{r}
fit_coffee_eda <-
  glm(
    formula = total_cup_points/100 ~ 
      owner + 
      country_of_origin + 
      company + 
      region +
      producer +
      number_of_bags +
      bag_weight +
      harvest_year +
      variety +
      processing_method +
      category_one_defects +
      quakers +
      color +
      category_two_defects +
      altitude_mean_meters,
    data = all_ratings %>%
      mutate(
        owner = owner %>% as.factor(),
        country_of_origin = country_of_origin %>% as.factor(),
        company = company %>% as.factor(),
        region = region %>% as.factor(),
        producer = producer %>% as.factor(),
        number_of_bags = number_of_bags %>% as.numeric(),
        bag_weight = bag_weight %>% as.factor(),
        harvest_year = harvest_year %>% as.numeric(),
        variety = variety %>% as.factor(),
        processing_method = processing_method %>% as.factor(),
        category_one_defects = category_one_defects %>% as.numeric(),
        quakers = quakers %>% as.numeric(),
        color = color %>% as.factor(),
        category_two_defects = category_two_defects %>% as.numeric(),
        altitude_mean_meters = altitude_mean_meters %>% as.numeric()
      ),
    family = "binomial"
  )
fit_tidy <- fit_coffee_eda %>% generics::tidy()
```