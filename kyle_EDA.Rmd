---
title: "R Notebook"
output: github_document
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r setup}
library(tidyverse)
source("cleaning.R")
```

```{r}
all_ratings %>%
  glimpse()
```
```{r}
all_ratings %>%
  ggplot() +
  geom_histogram(aes(altitude_mean_meters))
```

```{r}
all_ratings %>%
  group_by(country_of_origin)%>%
  mutate(count = n()) %>%
  ungroup()%>%
  mutate(country_of_origin = fct_reorder(country_of_origin, count)) %>%
  ggplot() +
  geom_bar(aes(country_of_origin)) +
  coord_flip()
```



```{r}
all_ratings %>%
  filter(total_cup_points >= 50) %>%
  mutate(country_of_origin = fct_reorder(country_of_origin, total_cup_points)) %>%
  ggplot() +
  geom_boxplot(aes(country_of_origin, total_cup_points)) +
  coord_flip()
```

```{r}
all_ratings %>%
  filter(total_cup_points >= 50) %>%
  mutate(alt_bins=cut_width(altitude_mean_meters, width=500, boundary=0)) %>%
  #mutate(country_of_origin = fct_reorder(country_of_origin, count)) %>%
  ggplot() +
  geom_boxplot(aes(alt_bins, total_cup_points)) +
  coord_flip()
```
```{r}
all_ratings %>%
  lm(data = .,
    formula = total_cup_points ~ aroma + flavor + aftertaste + acidity + body + balance + uniformity + clean_cup + sweetness
    # formula = total_cup_points ~ category_two_defects + category_one_defects
  ) %>%
  tidy()
```

```{r}
all_ratings %>%
  mutate(ratio = total_cup_points/cupper_points)
```

